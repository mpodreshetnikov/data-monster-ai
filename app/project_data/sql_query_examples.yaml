list:
  - question: Выведи первых 3 сотрудников/рабочих с должностью фармацевта в штате?
    tables: [dwh_uas.uas_data_user]
    query: |
      SELECT *
      FROM dwh_uas.uas_data_user
      WHERE position ILIKE 'Фармацевт' AND is_deleted = 0
      ORDER BY name
      LIMIT 3
  - question: Какая средняя сумма чека за все время?
    tables: [dwh_uas.uas_cash_cheque]
    query: |
      SELECT round(avg(result))
      FROM dwh_uas.uas_cash_cheque
      WHERE result != 0
  - question: Кто проводил чек с номером c8a0f515-6dc3-44ba-a31e-430637f58712?
    tables: [dwh_uas.uas_data_user, dwh_uas.uas_cash_cheque]
    query: |
      SELECT dwh_uas.uas_data_user
      FROM dwh_uas.uas_data_user
      JOIN dwh_uas.uas_cash_cheque
      ON dwh_uas.uas_cash_cheque.user_id = dwh_uas.uas_data_user.user_id 
      WHERE dwh_uas.uas_cash_cheque.cheque_id ='c8a0f515-6dc3-44ba-a31e-430637f58712'
  - question: Какая аптека проводила чек с номером c8a0f515-6dc3-44ba-a31e-430637f58712? 
    tables: [dwh_uas.uas_data_cnt_company, dwh_uas.uas_cash_cheque]
    query: |
      SELECT dwh_uas.uas_data_cnt_company
      FROM dwh_uas.uas_data_cnt_company
      JOIN dwh_uas.uas_cash_cheque
      ON dwh_uas.uas_cash_cheque.owner_id  = dwh_uas.uas_data_cnt_company.cnt_company_id  
      WHERE dwh_uas.uas_cash_cheque.cheque_id = 'c8a0f515-6dc3-44ba-a31e-430637f58712'
  - question: Сколько у аптеки 122 г Норильска продано Глицина?
    tables: [dwh_uas.uas_data_med_nomenclature_todel, dwh_uas.uas_data_cnt_company, dwh_uas.uas_cash_cheque_item]
    query: |
      SELECT Count(*)
      FROM dwh_uas.uas_cash_cheque 
      JOIN uas_cash_session_doc ucsd
      ON ucsd.session_id = dwh_uas.uas_cash_cheque.cash_session_id 
      JOIN dwh_uas.uas_cash_cheque_item
      ON dwh_uas.uas_cash_cheque_item.cheque_id = dwh_uas.uas_cash_cheque.cheque_id 
      JOIN dwh_uas.uas_data_med_nomenclature_todel udmn
      ON udmn.nomenclature_id = dwh_uas.uas_cash_cheque_item.nomencl_id 
      JOIN dwh_uas.uas_data_cnt_company
      ON ucsd.owner_id = dwh_uas.uas_data_cnt_company.cnt_company_id 
      WHERE 
        udmn."name" ILIKE '%глицин%'
        AND dwh_uas.uas_data_cnt_company."name" ILIKE  '%аптека 122%' 
        AND dwh_uas.uas_data_cnt_company."name" ILIKE  '%Норильск%' 
  - question: Сколько ежемесячно продаётся Нафтодерила
    tables: [dwh_uas.uas_data_med_nomenclature_todel, dwh_uas.uas_cash_cheque, dwh_uas.uas_cash_cheque_item]
    query: |
      SELECT
        DATE_TRUNC('month', dwh_uas.uas_cash_cheque.dt_create) AS month,
        SUM(dwh_uas.uas_cash_cheque_item.qty)
      FROM
        dwh_uas.uas_cash_cheque
        JOIN dwh_uas.uas_cash_cheque_item ON dwh_uas.uas_cash_cheque.cheque_id = dwh_uas.uas_cash_cheque_item.cheque_id
        JOIN dwh_uas.uas_data_med_nomenclature_todel ON dwh_uas.uas_cash_cheque_item.nomencl_id = dwh_uas.uas_data_med_nomenclature_todel.nomenclature_id     
      WHERE
        dwh_uas.uas_data_med_nomenclature_todel."name" ILIKE '%Нафтодерил%'
      GROUP BY
        month
      ORDER BY
        month DESC
      LIMIT 10
  - question: Выведи все возможные типы оплаты и типы скидок. 
    tables: [dwh_uas.uas_cash_cheque_sum]
    query: |
      SELECT distinct sum_type, discont_name
      FROM dwh_uas.uas_cash_cheque
      JOIN dwh_uas.uas_cash_cheque_item on dwh_uas.uas_cash_cheque_item.cheque_id = dwh_uas.uas_cash_cheque.cheque_id
      JOIN dwh_uas.uas_cash_cheque_sum on dwh_uas.uas_cash_cheque_sum.check_id = dwh_uas.uas_cash_cheque.cheque_id
      WHERE sum_type notnull and discont_name notnull